{% extends 'base.html' %}

{% block title %}Encontrar Mentores - Conecta Saberes{% endblock %}

{% block content %}

<div class="container-match">

    {% if tipo_visao == 'procurar_mentores' %}
    
        <div class="header-match">
            <h2>Encontre seu Mentor</h2>
            <p>Selecione uma 치rea para filtrar os profissionais dispon칤veis.</p>
        </div>

        <form action="{{ url_for('match') }}" method="GET" class="form-filtro">
            <label for="filtro-area">Filtrar por 츼rea:</label>
            <select name="area" id="filtro-area" onchange="this.form.submit()">
                <option value="">Todas as 치reas</option>
                <option value="Tecnologia" {% if request.args.get('area') == 'Tecnologia' %}selected{% endif %}>Tecnologia</option>
                <option value="Sa칰de" {% if request.args.get('area') == 'Sa칰de' %}selected{% endif %}>Sa칰de</option>
                <option value="Educa칞칚o" {% if request.args.get('area') == 'Educa칞칚o' %}selected{% endif %}>Educa칞칚o</option>
                <option value="Neg칩cios" {% if request.args.get('area') == 'Neg칩cios' %}selected{% endif %}>Neg칩cios</option>
                <option value="Artes" {% if request.args.get('area') == 'Artes' %}selected{% endif %}>Artes</option>
                <option value="Engenharia" {% if request.args.get('area') == 'Engenharia' %}selected{% endif %}>Engenharia</option>
                <option value="Humanas" {% if request.args.get('area') == 'Humanas' %}selected{% endif %}>Humanas</option>
            </select>
        </form>

        <hr>

        <div class="grid-mentores">
            {% for mentor in lista %}
                <div class="card-mentor">
                    <div class="card-header">
                        <img src="https://ui-avatars.com/api/?name={{ mentor['nome'] }}&background=random&color=fff&size=64&bold=true" 
                        alt="Foto de {{ mentor['nome'] }}"
                        width="60" height="60">
                        <div>
                            <h3>{{ mentor['nome'] }}</h3>
                            <span class="tag-area">{{ mentor['area'] }}</span>
                        </div>
                    </div>
                    
                    <div class="card-body">
                        <p class="bio-text">"{{ mentor['bio'] }}"</p>
                    </div>

                    <div class="card-footer">
                        <a href="https://wa.me/55{{ mentor['whatsapp'] }}?text=Ol치 {{ mentor['nome'] }}, vi seu perfil no Conecta Saberes e gostaria de solicitar uma mentoria." 
                           class="btn-whatsapp"
                           target="_blank"
                           onclick="registrarConexao({{ mentor['id'] }})">
                           
                           游눫 Solicitar Mentoria
                        </a>
                    </div>
                </div>
            {% else %}
                <div class="sem-resultados">
                    <p>Nenhum mentor encontrado nesta 치rea no momento.</p>
                    <a href="{{ url_for('match') }}">Ver todas as 치reas</a>
                </div>
            {% endfor %}
        </div>

    {% else %}
    
        <div class="painel-mentor">
            <h2>Ol치, Mentor(a)!</h2>
            <div class="card-status">
                <h3>Seu perfil est치 ativo</h3>
                <p>Voc칡 est치 vis칤vel para alunos de <strong>{{ session['user_area'] }}</strong> (sua 치rea cadastrada).</p>
                <p>Fique atento ao seu WhatsApp! Os alunos entrar칚o em contato por l치.</p>
                <br>
                <p><em>Dica: Mantenha sua biografia atualizada para atrair mais mentorados.</em></p>
            </div>
        </div>

    {% endif %}

</div>

<script>
    function registrarConexao(mentorId) {
        // Faz uma chamada "invis칤vel" para o backend
        fetch(`/registrar_conexao/${mentorId}`)
            .then(response => response.json())
            .then(data => console.log('Conex칚o registrada:', data))
            .catch(error => console.error('Erro ao registrar:', error));
            
        // O link do WhatsApp continuar치 abrindo normalmente
    }
</script>

{% endblock %}
